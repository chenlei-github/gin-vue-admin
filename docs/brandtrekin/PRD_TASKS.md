# 📝 开发任务清单

> **本文档提供完整的开发任务清单，按阶段组织，便于跟踪开发进度**

---

## 🎯 开发阶段概览

| 阶段 | 任务数 | 预估时间 | 优先级 |
|-----|-------|---------|--------|
| Phase 1: 数据库设计与搭建 | 10 | 1-2天 | 🔴 高 |
| Phase 2: 后端API开发 | 15 | 3-5天 | 🔴 高 |
| Phase 3: 前端展示页面开发 | 12 | 2-3天 | 🟡 中 |
| Phase 4: 后台管理页面开发 | 18 | 4-6天 | 🟡 中 |
| Phase 5: 测试与优化 | 10 | 2-3天 | 🟢 低 |
| Phase 6: 部署上线 | 8 | 1-2天 | 🟢 低 |

**总预估时间**：13-21天

---

## Phase 1：数据库设计与搭建

### 1.1 数据库环境准备
- [ ] 安装MySQL 8.0+
- [ ] 创建数据库 `brandtrekin`
- [ ] 配置字符集为 `utf8mb4`
- [ ] 创建数据库用户和权限

### 1.2 创建数据表
- [ ] 创建 `markets` 表
- [ ] 创建 `brands` 表
- [ ] 创建 `brand_social_media` 表
- [ ] 创建 `products` 表
- [ ] 创建 `product_monthly_sales` 表
- [ ] 创建 `keywords` 表
- [ ] 创建 `keyword_monthly_volume` 表
- [ ] 创建 `brand_monthly_trends` 表
- [ ] 创建 `market_monthly_trends` 表
- [ ] 创建 `import_logs` 表

### 1.3 创建索引和约束
- [ ] 创建所有主键索引
- [ ] 创建所有唯一索引
- [ ] 创建所有普通索引
- [ ] 创建所有外键约束
- [ ] 验证索引创建成功

### 1.4 准备测试数据
- [ ] 插入1-2个测试市场
- [ ] 插入5-10个测试品牌
- [ ] 插入20-50个测试商品
- [ ] 插入测试销售数据
- [ ] 验证数据关联正确

---

## Phase 2：后端API开发

### 2.1 项目基础搭建
- [ ] 初始化Next.js项目（如果需要）
- [ ] 配置TypeScript
- [ ] 配置环境变量（.env）
- [ ] 安装依赖包（Prisma/TypeORM、XLSX、PapaParse等）
- [ ] 配置ORM连接数据库

### 2.2 数据模型定义
- [ ] 定义Prisma Schema（或TypeORM Entity）
- [ ] 生成Prisma Client
- [ ] 创建TypeScript类型定义
- [ ] 验证模型与数据库表对应

### 2.3 前端展示API
- [ ] 实现 `GET /api/markets` - 获取市场列表
- [ ] 实现 `GET /api/markets/:id` - 获取市场详情
- [ ] 实现 `GET /api/markets/:id/brands/:brand` - 获取品牌详情
- [ ] 实现数据格式化工具函数
- [ ] 实现CAGR计算函数
- [ ] 编写单元测试

### 2.4 市场管理API
- [ ] 实现 `GET /api/admin/markets` - 获取市场列表
- [ ] 实现 `POST /api/admin/markets` - 创建市场
- [ ] 实现 `PUT /api/admin/markets/:id` - 更新市场
- [ ] 实现 `DELETE /api/admin/markets/:id` - 删除市场
- [ ] 实现市场slug唯一性校验
- [ ] 实现级联删除逻辑
- [ ] 编写单元测试

### 2.5 文件上传和解析
- [ ] 实现文件上传接口
- [ ] 实现Brand-Social.xlsx解析
- [ ] 实现GKW.csv解析
- [ ] 实现KeywordHistory.xlsx解析
- [ ] 实现Product-US.xlsx解析
- [ ] 实现product-US-sales.xlsx解析
- [ ] 实现文件校验逻辑
- [ ] 实现数据预览功能
- [ ] 编写单元测试

### 2.6 数据导入逻辑
- [ ] 实现数据导入主流程
- [ ] 实现品牌数据导入
- [ ] 实现商品数据导入
- [ ] 实现关键词数据导入
- [ ] 实现销售数据导入
- [ ] 实现聚合指标计算
- [ ] 实现CAGR计算
- [ ] 实现事务处理和回滚
- [ ] 实现导入进度跟踪
- [ ] 实现导入日志记录
- [ ] 编写单元测试

### 2.7 导入历史API
- [ ] 实现 `GET /api/admin/markets/:id/import-history` - 获取导入历史
- [ ] 实现 `GET /api/admin/import-logs/:id` - 获取导入详情
- [ ] 编写单元测试

---

## Phase 3：前端展示页面开发

### 3.1 首页 - 市场列表页
- [ ] 保持现有页面布局
- [ ] 将数据源从JSON改为API调用
- [ ] 实现4个核心指标卡片
- [ ] 实现市场列表表格
- [ ] 实现市场趋势预览图
- [ ] 实现数据格式化
- [ ] 实现加载状态
- [ ] 实现错误处理
- [ ] 测试响应式布局

### 3.2 市场详情页
- [ ] 保持现有页面布局
- [ ] 将数据源从JSON改为API调用
- [ ] 实现4个核心指标卡片
- [ ] 实现市场趋势双轴图表
- [ ] 实现品牌销售额占比饼图
- [ ] 实现品牌销售额排名柱状图
- [ ] 实现品牌列表表格
- [ ] 实现社交媒体图标显示
- [ ] 实现加载状态
- [ ] 实现错误处理
- [ ] 测试响应式布局

### 3.3 品牌详情页
- [ ] 保持现有页面布局
- [ ] 将数据源从JSON改为API调用
- [ ] 实现4个核心指标卡片
- [ ] 实现品牌销售趋势折线图
- [ ] 实现社交媒体4个卡片
- [ ] 实现商品网格布局
- [ ] 实现商品卡片（含销售趋势迷你图）
- [ ] 实现加载状态
- [ ] 实现错误处理
- [ ] 测试响应式布局

---

## Phase 4：后台管理页面开发

### 4.1 后台布局搭建
- [ ] 设计后台管理布局（侧边栏+顶栏）
- [ ] 实现侧边栏导航菜单
- [ ] 实现顶栏（用户信息、退出等）
- [ ] 实现面包屑导航
- [ ] 实现响应式布局

### 4.2 市场管理模块
- [ ] 实现市场列表页
- [ ] 实现市场列表表格
- [ ] 实现状态开关切换
- [ ] 实现添加市场页
- [ ] 实现市场表单（含校验）
- [ ] 实现市场slug自动生成
- [ ] 实现市场slug唯一性校验
- [ ] 实现编辑市场页
- [ ] 实现删除市场确认弹窗
- [ ] 实现删除市场功能
- [ ] 实现成功/失败提示

### 4.3 数据导入模块
- [ ] 实现数据导入页布局
- [ ] 实现5个文件上传组件
- [ ] 实现文件选择和上传
- [ ] 实现文件解析和预览
- [ ] 实现导入选项（模式、校验）
- [ ] 实现开始导入按钮
- [ ] 实现导入进度条
- [ ] 实现导入日志实时输出
- [ ] 实现导入成功统计显示
- [ ] 实现导入失败错误显示
- [ ] 实现取消导入功能

### 4.4 导入历史模块
- [ ] 实现导入历史列表页
- [ ] 实现导入历史表格
- [ ] 实现查看导入详情
- [ ] 实现查看导入日志
- [ ] 实现状态标签显示

---

## Phase 5：测试与优化

### 5.1 功能测试
- [ ] 测试市场CRUD功能
- [ ] 测试数据导入功能（5种文件）
- [ ] 测试增量导入模式
- [ ] 测试全量替换模式
- [ ] 测试数据校验功能
- [ ] 测试错误处理
- [ ] 测试前端所有页面功能
- [ ] 测试所有交互功能

### 5.2 数据准确性测试
- [ ] 验证CAGR计算正确性
- [ ] 验证市场规模计算正确性
- [ ] 验证搜索量汇总正确性
- [ ] 验证品牌销售额汇总正确性
- [ ] 验证商品销售趋势正确性
- [ ] 对比原JSON数据和数据库数据

### 5.3 性能测试
- [ ] 测试大数据量导入（1000+商品）
- [ ] 测试页面加载速度
- [ ] 测试图表渲染性能
- [ ] 优化慢查询
- [ ] 优化前端渲染

### 5.4 兼容性测试
- [ ] 测试Chrome浏览器
- [ ] 测试Safari浏览器
- [ ] 测试Firefox浏览器
- [ ] 测试移动端浏览器
- [ ] 测试响应式布局

### 5.5 代码优化
- [ ] 代码重构和优化
- [ ] 添加代码注释
- [ ] 统一代码风格
- [ ] 移除调试代码
- [ ] 优化错误处理

---

## Phase 6：部署上线

### 6.1 生产环境准备
- [ ] 配置生产数据库
- [ ] 配置环境变量
- [ ] 配置域名和SSL证书
- [ ] 配置CDN（如需要）

### 6.2 构建和部署
- [ ] 构建生产版本
- [ ] 部署到服务器（Vercel/自建）
- [ ] 配置Nginx（如自建）
- [ ] 配置PM2（如自建）
- [ ] 验证部署成功

### 6.3 监控和日志
- [ ] 配置错误监控（Sentry等）
- [ ] 配置性能监控
- [ ] 配置日志收集
- [ ] 配置数据库备份

### 6.4 文档和培训
- [ ] 编写用户使用手册
- [ ] 编写运维文档
- [ ] 培训管理员使用后台
- [ ] 准备常见问题FAQ

---

## 📊 进度跟踪

### 使用方法
1. 复制本文档到项目管理工具（如Notion、Trello）
2. 每完成一项任务，勾选对应的复选框
3. 定期回顾进度，调整计划

### 优先级说明
- 🔴 **高优先级**：必须完成，阻塞其他任务
- 🟡 **中优先级**：重要功能，按计划完成
- 🟢 **低优先级**：优化项，可延后

---

## ✅ 完成标准

### Phase 1 完成标准
- 所有数据表创建成功
- 所有索引和约束创建成功
- 可以手动插入和查询测试数据

### Phase 2 完成标准
- 所有API接口开发完成
- 所有单元测试通过
- API文档完整

### Phase 3 完成标准
- 所有前端展示页面正常显示
- 所有数据从API获取
- 所有交互功能正常

### Phase 4 完成标准
- 所有后台管理功能正常
- 可以成功导入数据
- 数据导入后前端正常显示

### Phase 5 完成标准
- 所有功能测试通过
- 数据准确性验证通过
- 性能测试达标

### Phase 6 完成标准
- 生产环境部署成功
- 监控和日志配置完成
- 文档编写完成

---

## 🎉 项目完成检查清单

### 功能完整性
- [ ] 前端3个页面全部正常
- [ ] 后台管理全部功能正常
- [ ] 数据导入全流程正常
- [ ] 所有数据指标计算正确

### 代码质量
- [ ] 代码规范统一
- [ ] 注释完整
- [ ] 无明显bug
- [ ] 性能达标

### 文档完整性
- [ ] 产品需求文档完整
- [ ] API文档完整
- [ ] 数据库文档完整
- [ ] 用户手册完整

### 部署和运维
- [ ] 生产环境部署成功
- [ ] 监控配置完成
- [ ] 备份策略制定
- [ ] 应急预案准备

---

**开发任务清单完成！祝开发顺利！🚀**
