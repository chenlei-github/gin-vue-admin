# 📋 BrandTrekin 产品需求文档（PRD）

> **适用于 Cursor AI 开发的完整产品需求文档**  
> **版本**: v1.0  
> **更新时间**: 2025-10-28

---

## 🎯 项目概述

**项目名称**：BrandTrekin - 品牌市场分析平台  
**项目类型**：全栈Web应用（前端展示 + 后台管理 + 数据库）  
**开发目标**：将现有基于JSON文件的静态展示系统，升级为基于MySQL数据库的动态管理系统

### 核心功能模块

1. **前端展示系统**（保持现有UI/UX）
   - 市场列表页：展示所有市场的核心指标和趋势
   - 市场详情页：展示单个市场的详细数据、品牌分布、趋势图表
   - 品牌详情页：展示品牌销售趋势、社交媒体数据、商品列表

2. **后台管理系统**（全新开发）
   - 市场管理：创建、编辑、删除市场
   - 数据导入：上传并解析5种类型的Excel/CSV文件
   - 导入历史：查看历史导入记录和日志

3. **数据库系统**（全新设计）
   - 10张核心数据表
   - 自动计算聚合指标（CAGR、市场规模等）
   - 支持增量导入和全量替换

---

## 🛠 技术栈

### 前端技术
```json
{
  "framework": "Next.js 14 (App Router)",
  "language": "TypeScript",
  "ui_library": "React 18",
  "styling": "Tailwind CSS",
  "charts": "Recharts",
  "icons": "Lucide React",
  "http_client": "Axios",
  "state_management": "React Hooks"
}
```

### 后端技术
```json
{
  "runtime": "Node.js 20+",
  "framework": "Next.js API Routes",
  "database": "MySQL 8.0+",
  "orm": "Prisma (推荐) 或 TypeORM",
  "file_parser": {
    "excel": "xlsx",
    "csv": "papaparse"
  },
  "validation": "Zod"
}
```

### 开发工具
```json
{
  "package_manager": "npm",
  "version_control": "Git",
  "code_editor": "Cursor AI",
  "deployment": "Vercel 或 自建服务器"
}
```

---

## 📚 文档索引

本产品需求文档分为以下几个部分，请按顺序阅读：

### 1️⃣ [前端展示需求](./PRD_FRONTEND.md)
- 首页 - 市场列表页的完整布局和数据指标
- 市场详情页的完整布局和数据指标
- 品牌详情页的完整布局和数据指标
- 所有页面的数据计算公式
- UI/UX设计规范

### 2️⃣ [后台管理需求](./PRD_ADMIN.md)
- 市场管理模块（CRUD操作）
- 数据导入模块（5种文件类型）
- 数据解析逻辑（详细的解析规则）
- 导入流程和进度显示
- 导入历史记录

### 3️⃣ [数据库设计](./PRD_DATABASE.md)
- 10张核心数据表的完整SQL
- 表关系和外键约束
- 索引设计
- 核心计算逻辑（存储过程/定时任务）
- CAGR计算公式
- 数据聚合逻辑

### 4️⃣ [API接口设计](./PRD_API.md)
- 前端展示API（3个核心接口）
- 后台管理API（市场管理、数据导入）
- 请求/响应格式
- 错误处理规范

### 5️⃣ [开发任务清单](./PRD_TASKS.md)
- Phase 1: 数据库设计与搭建
- Phase 2: 后端API开发
- Phase 3: 前端展示页面开发
- Phase 4: 后台管理页面开发
- Phase 5: 测试与优化
- Phase 6: 部署上线

---

## 🎨 设计原则

### 前端展示页面
- ✅ **保持现有布局**：不改变现有页面的布局结构
- ✅ **保持现有交互**：不改变现有的用户交互方式
- ✅ **保持现有样式**：不改变现有的视觉风格
- ⚠️ **仅改变数据源**：从读取JSON文件改为调用API接口

### 后台管理页面
- 🆕 **全新设计**：参考现代化后台管理系统（如Ant Design Pro）
- 🆕 **简洁易用**：操作流程清晰，减少用户学习成本
- 🆕 **实时反馈**：导入进度实时显示，错误信息明确

---

## ⚠️ 重要注意事项

### 数据完整性
1. **不要遗漏任何指标**：前端展示的每一个数据指标都必须在数据库中有对应字段
2. **计算公式必须准确**：特别是CAGR、市场规模、搜索量等核心指标
3. **数据关联必须正确**：品牌、商品、关键词等数据必须正确关联到市场

### 数据导入
1. **5个文件缺一不可**：Brand-Social.xlsx、GKW.csv、KeywordHistory.xlsx、Product-US.xlsx、product-US-sales.xlsx
2. **解析逻辑必须严格**：按照文档中的解析规则，不能随意修改
3. **数据校验必须完善**：导入前必须校验数据格式和必填字段
4. **事务处理必须完整**：导入失败时必须回滚所有数据

### 性能优化
1. **大数据量处理**：商品销售数据可能有数万条，需要批量插入
2. **索引优化**：为常用查询字段添加索引
3. **缓存策略**：前端展示数据可以考虑缓存

---

## 📞 开发支持

如果在开发过程中遇到问题，请参考以下资源：

1. **现有代码**：`/src/app/page.tsx`、`/src/lib/parseData.js`
2. **数据样例**：`/data/markets/` 目录下的JSON文件
3. **类型定义**：`/src/types/market.ts`

---

## 🚀 快速开始

### 第一步：阅读完整需求
请按顺序阅读以下文档：
1. [前端展示需求](./PRD_FRONTEND.md) - 了解所有页面的展示需求
2. [后台管理需求](./PRD_ADMIN.md) - 了解后台管理功能
3. [数据库设计](./PRD_DATABASE.md) - 了解数据库表结构
4. [API接口设计](./PRD_API.md) - 了解接口规范

### 第二步：搭建开发环境
```bash
# 1. 安装依赖
npm install

# 2. 配置数据库
# 创建 .env 文件，配置数据库连接

# 3. 初始化数据库
npx prisma migrate dev

# 4. 启动开发服务器
npm run dev
```

### 第三步：按阶段开发
参考 [开发任务清单](./PRD_TASKS.md)，按照Phase 1-6的顺序进行开发。

---

## 📝 版本历史

- **v1.0** (2025-10-28): 初始版本，包含完整的产品需求文档

---

**祝开发顺利！🎉**
