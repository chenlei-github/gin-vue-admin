# 数据格式分析报告

## 概述

本报告详细分析了 `./trekin-main/data` 目录下所有数据文件的格式特点，包括文件结构、表头位置、列信息以及多 sheet 情况。

**文件统计：**
- 总文件数：15 个
- Excel 文件：12 个
- CSV 文件：3 个
- 所有 Excel 文件都包含多个 sheet（2-11 个不等）

---

## 一、Brand-Social.xlsx（品牌社交媒体数据）

### 文件位置
- `CNCRouter/Brand-Social.xlsx`
- `LaserEngraver/Brand-Social.xlsx`
- `ThermalCamera/Brand-Social.xlsx`

### Sheet 结构
每个文件包含 **2 个 sheet**：

#### 1. Report Sheet（主数据）
- **表头位置**：第 1 行
- **数据起始行**：第 2 行
- **列数**：12 列
- **列名**：
  - Brand
  - Website
  - YouTube URL
  - YouTube Subscribers
  - Instagram URL
  - Instagram Followers
  - Facebook URL
  - Facebook Followers/Likes
  - Reddit URL/Search
  - Reddit Mentions (approx)
  - Heat Score (log-based)
  - Top 5 Hot Links (across platforms)

#### 2. Method Sheet（方法说明）
- **表头位置**：第 1 行
- **列数**：2 列
- **列名**：
  - Field
  - Definition / Formula
- **用途**：说明字段定义和计算公式

---

## 二、Product-US.xlsx（美国商品数据）

### 文件位置
- `CNCRouter/Product-US.xlsx`（114 个产品）
- `LaserEngraver/Product-US.xlsx`（193 个产品）
- `ThermalCamera/Product-US.xlsx`（100 个产品）

### Sheet 结构
每个文件包含 **2 个 sheet**：

#### 1. 主数据 Sheet（如：US-CNCRouterMachine(114)）
- **标题行**：第 1 行（包含文件名和日期信息，如：`Product-US-CNCRouterMachine(114)-20251014`）
- **表头位置**：第 2 行
- **数据起始行**：第 3 行
- **列数**：64 列（实际数据列）
- **主要列名**（前 10 列）：
  - ASIN
  - SKU
  - 详细参数
  - 品牌
  - 品牌链接
  - 商品标题
  - 商品详情页链接
  - 商品主图
  - 父ASIN
  - 类目路径

**注意**：第一行是标题行，不是表头，需要跳过第一行，从第二行开始读取表头。

#### 2. Notes Sheet（说明）
- **列数**：1 列
- **内容**：卖家精灵官网链接说明

---

## 三、KeywordHistory.xlsx（Amazon 关键词历史数据）

### 文件位置
- `CNCRouter/KeywordHistory.xlsx`（11 个历史 sheet）
- `LaserEngraver/KeywordHistory.xlsx`（9 个历史 sheet）
- `ThermalCamera/KeywordHistory.xlsx`（5 个历史 sheet）

### Sheet 结构
每个文件包含 **多个历史关键词 sheet + 1 个 Notes sheet**：

#### 历史关键词 Sheet（每个关键词一个 sheet）
- **标题行**：第 1 行（包含关键词名称和日期，如：`KeywordHistory-cnc router machine-US-20251014`）
- **表头位置**：第 2 行
- **数据起始行**：第 3 行
- **列数**：20 列
- **主要列名**（前 10 列）：
  - 站点
  - 月份
  - 关键词
  - ABA排名
  - 月搜索量
  - 搜索增长率
  - 月购买量
  - 购买率
  - 展示量
  - 点击量

**CNCRouter 的所有历史 sheet：**
1. History-cnc router machine-US
2. History-cnc machine-US
3. History-cnc router-US
4. History-router cnc-US
5. History-wood cnc router machi5
6. History-cnc milling machine-US
7. History-cnc machines-US
8. History-wood cnc machine-US
9. History-cnc-US
10. History-desktop cnc-US

**LaserEngraver 的所有历史 sheet：**
1. History-laser engraver-US
2. History-laser engraver machin2
3. History-laser engraving machi3
4. History-laser cutter-US
5. History-engraving machine-US
6. History-laser cutting machine6
7. History-laser cutter machine-7
8. History-lazer engraving machi8

**ThermalCamera 的所有历史 sheet：**
1. History-thermal camera-US
2. History-thermal imaging camer2
3. History-infrared camera-US
4. History-thermal imager-US

**注意**：
- 每个历史 sheet 代表一个关键词的历史数据
- 第一行是标题行，需要跳过
- 需要遍历所有历史 sheet（排除 Notes sheet）进行数据导入

#### Notes Sheet
- **名称**：Notes (2) 或 Notes
- **列数**：1 列
- **内容**：卖家精灵官网链接说明

---

## 四、product-US-sales.xlsx（商品销售数据）

### 文件位置
- `CNCRouter/product-US-sales.xlsx`
- `LaserEngraver/product-US-sales.xlsx`
- `ThermalCamera/product-US-sales.xlsx`

### Sheet 结构
每个文件包含 **3 个 sheet**：

#### 1. 产品历史月销量 Sheet
- **表头位置**：第 1 行
- **数据起始行**：第 2 行
- **列数**：33 列
- **列结构**：
  - 前 6 列为商品基本信息
  - 后续列为时间序列数据（月份）
- **主要列名**：
  - 图片
  - ASIN
  - SKU
  - URL
  - 所属类目
  - 商品标题
  - 2025-10
  - 2025-09
  - 2025-08
  - ...（更多月份列）

#### 2. 产品历史月销售额 Sheet
- **表头位置**：第 1 行
- **数据起始行**：第 2 行
- **列数**：33 列
- **列结构**：与月销量 sheet 类似，但列名带美元符号
- **主要列名**：
  - 图片
  - ASIN
  - SKU
  - URL
  - 所属类目
  - 商品标题
  - 2025-10($)
  - 2025-09($)
  - 2025-08($)
  - ...（更多月份列）

#### 3. Notes Sheet（说明）
- **列数**：1 列
- **内容**：卖家精灵官网链接说明

---

## 五、GKW.csv（Google 关键词数据）

### 文件位置
- `CNCRouter/GKW.csv`
- `LaserEngraver/GKW.csv`
- `ThermalCamera/GKW.csv`（此文件编码有问题，可能需要特殊处理）

### 文件格式
- **文件类型**：CSV
- **表头位置**：第 1 行（索引为 0）
- **数据起始行**：第 2 行（索引为 1）
- **编码**：UTF-8（CNCRouter 和 LaserEngraver 成功，ThermalCamera 需要尝试其他编码）

### CNCRouter/GKW.csv
- **列数**：62 列
- **主要列名**（前 15 列）：
  - Keyword
  - Currency
  - Segmentation
  - Avg. monthly searches
  - Three month change
  - YoY change
  - Competition
  - Competition (indexed value)
  - Top of page bid (low range)
  - Top of page bid (high range)
  - Ad impression share
  - Organic average position
  - Organic impression share
  - In Account
  - Searches: Sep 2021
  - ...（后续为时间序列列，从 2021 年 9 月到 2025 年 8 月）

### LaserEngraver/GKW.csv
- **列数**：60 列
- **列名**：与 CNCRouter 类似，但缺少 Currency 和 Segmentation 列
- **主要列名**：
  - Keyword
  - Avg. monthly searches
  - Three month change
  - YoY change
  - Competition
  - ...（后续为时间序列列）

---

## 关键格式特点总结

### 1. 表头位置差异
- **Brand-Social.xlsx**：表头在第 1 行
- **Product-US.xlsx**：标题行在第 1 行，表头在第 2 行（需要跳过第一行）
- **KeywordHistory.xlsx**：标题行在第 1 行，表头在第 2 行（需要跳过第一行）
- **product-US-sales.xlsx**：表头在第 1 行
- **GKW.csv**：表头在第 1 行

### 2. 多 Sheet 情况
- **所有 Excel 文件都包含多个 sheet**
- **KeywordHistory.xlsx** 包含最多的 sheet（4-11 个历史 sheet）
- **需要特别注意**：有些 sheet 是说明性的（如 Method、Notes），导入时需要过滤

### 3. 数据 Sheet 识别规则
- **Brand-Social.xlsx**：使用 "Report" sheet
- **Product-US.xlsx**：使用主数据 sheet（通常名称包含产品数量和日期，如 "US-CNCRouterMachine(114)"）
- **KeywordHistory.xlsx**：所有以 "History-" 开头的 sheet 都是数据 sheet
- **product-US-sales.xlsx**：使用 "产品历史月销量" 和 "产品历史月销售额" sheet

### 4. 编码问题
- **ThermalCamera/GKW.csv** 可能存在编码问题，需要尝试多种编码（UTF-8, GBK, GB2312, Latin-1）

### 5. 时间序列数据
- **GKW.csv**：包含从 2021 年 9 月到 2025 年 8 月的时间序列数据
- **product-US-sales.xlsx**：包含从 2023 年 8 月到 2025 年 10 月的时间序列数据

---

## 数据导入建议

### 1. Excel 文件导入流程
1. 打开 Excel 文件
2. 获取所有 sheet 名称
3. 根据文件类型识别数据 sheet：
   - Brand-Social：使用 "Report" sheet
   - Product-US：使用主数据 sheet（排除 "Notes"）
   - KeywordHistory：遍历所有 "History-" 开头的 sheet
   - product-US-sales：使用 "产品历史月销量" 和 "产品历史月销售额" sheet
4. 根据表头位置读取表头（注意跳过标题行）
5. 从数据起始行开始读取数据

### 2. CSV 文件导入流程
1. 尝试 UTF-8 编码读取
2. 如果失败，尝试 GBK、GB2312、Latin-1 等编码
3. 表头在第 1 行（索引 0）
4. 数据从第 2 行（索引 1）开始

### 3. 数据验证
- 检查必填列是否存在（如 Brand-Social 的 "Brand" 列）
- 检查数据行的列数是否与表头一致
- 处理空值和格式异常

---

## 文件结构图

```
trekin-main/data/
├── CNCRouter/
│   ├── Brand-Social.xlsx (2 sheets: Report, Method)
│   ├── GKW.csv (62 columns)
│   ├── KeywordHistory.xlsx (11 sheets: 10 History-* + Notes)
│   ├── Product-US.xlsx (2 sheets: US-CNCRouterMachine(114), Notes)
│   └── product-US-sales.xlsx (3 sheets: 产品历史月销量, 产品历史月销售额, Notes)
├── LaserEngraver/
│   ├── Brand-Social.xlsx (2 sheets: Report, Method)
│   ├── GKW.csv (60 columns)
│   ├── KeywordHistory.xlsx (9 sheets: 8 History-* + Notes)
│   ├── Product-US.xlsx (2 sheets: US-LaserEngraver(193), Notes)
│   └── product-US-sales.xlsx (3 sheets: 产品历史月销量, 产品历史月销售额, Notes)
└── ThermalCamera/
    ├── Brand-Social.xlsx (2 sheets: Report, Method)
    ├── GKW.csv (编码问题)
    ├── KeywordHistory.xlsx (5 sheets: 4 History-* + Notes)
    ├── Product-US.xlsx (2 sheets: US-Thermal(100), Notes)
    └── product-US-sales.xlsx (3 sheets: 产品历史月销量, 产品历史月销售额, Notes)
```

---

**报告生成时间**：2025-01-XX  
**分析工具**：Python + pandas + openpyxl

